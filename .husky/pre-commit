#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo 'ğŸ‘ Preparing to commit. Running tests and build...'

# Check Prettier standards
npm run format
git add .

npm run check-format || (
    echo 'âŒ Prettier check failed! Your code needs some cleaning. Run "npm run format", add the changes and try committing again.'
    false;
)

# Check ESLint Standards
npm run check-lint || (
    echo 'âŒ ESLint check failed! Your code needs some fixing. Make the required changes listed above, add changes and try committing again.'
    false;
)

# Check tsconfig standards
npm run check-types || (
    echo 'âŒ Type check failed! You have some errors to fix. Make the required changes listed above and try committing again.'
    false;
)

# Run tests
echo 'ğŸ§ª Running tests...'
npm run test || (
    echo 'âŒ Tests failed! Please check the error messages above to fix the issue.'
    false;
)

# Build the project
echo 'ğŸ”¨ Building project...'
npm run build || (
    echo 'âŒ Build failed! Please check the error messages above to fix the issue.'
    false;
)

# If everything passes, commit
echo 'âœ… Tests passed, build successful. Ready to commit!'
